!function(e){"use strict";e.fn.zozotimeline=function(t){var n=e.extend({distance:60},t).distance,i=e(this);function r(e,t,i){var r=f(e.eventsWrapper),a=Number(e.timelineWrapper.css("width").replace("px",""));"next"==i?l(e,r-a+n,a-t):l(e,r+a-n)}function a(e,t,n){var i,r,a,d,v,c,m,u,g=e.eventsContent.find(".selected");if(("next"==n?g.next():g.prev()).length>0){var h=e.eventsWrapper.find(".selected"),w="next"==n?h.parent("li").next("li").children("a"):h.parent("li").prev("li").children("a");s(w,e.fillingLine,t),o(w,e.eventsContent),w.addClass("selected"),h.removeClass("selected"),p(w),i=n,r=w,a=e,d=t,v=window.getComputedStyle(r.get(0),null),c=Number(v.getPropertyValue("left").replace("px","")),m=Number(a.timelineWrapper.css("width").replace("px","")),d=Number(a.eventsWrapper.css("width").replace("px","")),u=f(a.eventsWrapper),("next"==i&&c>m-u||"prev"==i&&c<-u)&&l(a,m/2-c,m-d)}}function l(e,t,n){var i=e.eventsWrapper.get(0);t=t>0?0:t,d(i,"translateX",(t=void 0!==n&&t<n?n:t)+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function s(e,t,n){var i=window.getComputedStyle(e.get(0),null),r=i.getPropertyValue("left"),a=i.getPropertyValue("width"),l=(r=Number(r.replace("px",""))+Number(a.replace("px",""))/2)/n;d(t.get(0),"scaleX",l)}function o(e,t){var n=e.data("date"),i=t.find(".selected"),r=t.find('[data-date="'+n+'"]'),a=r.height();if(r.index()>i.index())var l="selected enter-right",s="leave-left";else l="selected enter-left",s="leave-right";r.attr("class",l),i.attr("class",s).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){i.removeClass("leave-right leave-left"),r.removeClass("enter-left enter-right")}),t.css("height",a+"px")}function p(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function f(e){var t=window.getComputedStyle(e.get(0),null);if((n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")).indexOf("(")>=0)var n,i=(n=(n=(n=n.split("(")[1]).split(")")[0]).split(","))[4];else i=0;return Number(i)}function d(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function v(e,t){return Math.round(t-e)}function c(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}function m(){return window.getComputedStyle(document.querySelector(".cd-horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}i.each(function(){var t,i,l=e(this),f={};f.timelineWrapper=l.find(".events-wrapper"),f.eventsWrapper=f.timelineWrapper.children(".events"),f.fillingLine=f.eventsWrapper.children(".filling-line"),f.timelineEvents=f.eventsWrapper.find("a"),f.timelineDates=(t=f.timelineEvents,i=[],t.each(function(){var t=e(this).data("date").split("/"),n=new Date(t[2],t[1]-1,t[0]);i.push(n)}),i),f.eventsMinLapse=function(e){var t,n=[];for(t=1;t<e.length;t++){var i=v(e[t-1],e[t]);n.push(i)}return Math.min.apply(null,n)}(f.timelineDates),f.timelineNavigation=l.find(".cd-timeline-navigation"),f.eventsContent=l.children(".events-content"),function(e,t){var n;for(n=0;n<e.timelineDates.length;n++){var i=v(e.timelineDates[0],e.timelineDates[n]),r=Math.round(i/e.eventsMinLapse)+2;e.timelineEvents.eq(n).css("left",r*t+"px")}}(f,n);var d,u,g,h,w=(u=n,g=v((d=f).timelineDates[0],d.timelineDates[d.timelineDates.length-1])/d.eventsMinLapse,h=(g=Math.round(g)+4)*u,d.eventsWrapper.css("width",h+"px"),s(d.timelineEvents.eq(0),d.fillingLine,h),h);l.addClass("loaded"),f.timelineNavigation.on("click",".next",function(e){e.preventDefault(),r(f,w,"next")}),f.timelineNavigation.on("click",".prev",function(e){e.preventDefault(),r(f,w,"prev")}),f.eventsWrapper.on("click","a",function(t){t.preventDefault(),f.timelineEvents.removeClass("selected"),e(this).addClass("selected"),p(e(this)),s(e(this),f.fillingLine,w),o(e(this),f.eventsContent)}),f.eventsContent.on("swipeleft",function(){var e=m();"mobile"==e&&a(f,w,"next")}),f.eventsContent.on("swiperight",function(){var e=m();"mobile"==e&&a(f,w,"prev")}),e(document).keyup(function(e){"37"==e.which&&c(l.get(0))?a(f,w,"prev"):"39"==e.which&&c(l.get(0))&&a(f,w,"next")})})}}(jQuery);